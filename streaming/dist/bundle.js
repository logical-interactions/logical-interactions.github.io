!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist",t(t.s=5)}([function(e,t){e.exports=React},function(e,t,n){"use strict";function r(e){return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}function a(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),200===t.status?t.responseText:""}function i(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onload=function(){return t(r.responseText)},r.onerror=function(){return n(r.statusText)},r.send()})}Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.data=0]="data",e[e.scale=1]="scale"}(t.SelectionDesign||(t.SelectionDesign={})),t.getFormattedTime=r,t.readFileSync=a,t.readFileAsync=i},function(e,t){e.exports=d3},function(e,t,n){"use strict";function r(e){try{t.db.run(e)}catch(t){console.log("%cDB execution error for query "+e+", "+t,"background: red")}}function a(e){var n=t.db.exec(e);n.length>0?(n[0].values.map(function(e){e.map(function(e,t){"ts"===n[0].columns[t]&&(e=new Date(e).toDateString())})}),console.log(n[0].columns.join("\t")),console.log(JSON.stringify(n[0].values).replace(/\],\[/g,"\n").replace("[[","").replace("]]","").replace(/,/g,"\t"))):console.log("NO RESULT")}function i(e,n){var r=v?"./dist/sql":"/src/sql",a=g.readFileSync(r+"/"+e+"/"+n+".sql"),i=a.split(";\n\n");i.forEach(function(e,n){e=e.replace(/^ *--.*$/gm,""),n<i.length-1&&(e+=";"),console.log("executing ",e),t.db.run(e)})}function o(e,t){return console.log("["+t+"] "+e),1}function s(){return+new Date}function l(e,t,n){if(e>t)throw new Error(e+" is larger than "+t+", "+n)}function c(e,t){var n=document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.onclick=function(){setTimeout(function(){window.URL.revokeObjectURL(n.href)},1500)},n.click()}function u(){console.log("download session");var e=t.db.export();c(new Blob([e]),"session.db")}function d(e){var n="",r=t.db.exec(e);if(r.length&&r[0].values){n+=r[0].columns.join(",")+"\r\n",r[0].values.forEach(function(e){var t=e.join(",");n+=t+"\r\n"});c(new Blob([n],{type:"text/plain;charset=UTF-8"}),"userData.csv"),console.log("should have downloaded",n)}else console.log("NO RESULT")}function h(e){var n=new FileReader;n.onload=function(){console.log("Updated to the updated session");var e=new Uint8Array(n.result);t.db=new p.Database(e)},n.readAsArrayBuffer(e)}function f(e){return"set"+e+"PendingState"}function m(e){return"set"+e+"DataState"}Object.defineProperty(t,"__esModule",{value:!0});var p=n(9),g=n(1),v=!0;console.log("DB setup file executing"),t.db=new p.Database,window.db=t.db,t.db.run("PRAGMA foreign_keys = ON;"),t.tryDB=r,window.d=a,t.executeFile=i,t.db.create_function("timeNow",s),t.db.create_function("log",o),t.db.create_function("assertNoBigger",l),t.downloadDB=u,window.downloadDB=u,t.downloadQueryResultAsCSV=d,t.loadDb=h,t.getComponentPendingFuncName=f,t.getComponentStateFuncName=m},function(e,t,n){"use strict";function r(){function e(e,n){void 0===e&&(e=1e3),void 0===n&&(n=0);var i=m.randomNormal(10,5),o=i(),s=[1,1,1].map(function(e){return a.charAt(Math.floor(Math.random()*a.length))}).join(""),l=t.aSeries[Math.floor(3*Math.random())],c=t.bSeries[Math.floor(3*Math.random())];setTimeout(function(){r.run([+new Date-n,o,s,l,c])},Math.random()*e)}function n(e){void 0===e&&(e=1e3);var t=m.randomNormal(10,2),n=p.db.exec("SELECT id FROM events ORDER BY RANDOM() LIMIT 1");if(n.length>0){var r=t(),a=r+Math.random(),o=n[0].values[0][0],s=p.db.exec("select c, d from user where id = '"+o+"'");s.length>0&&(r=s[0].values[0][0]+Math.random(),a=s[0].values[0][1]+Math.random()),setTimeout(function(){i.run([+new Date,o,r,a])},Math.random()*e)}else console.log("Weird that there is no events")}["static","tables","views","triggers"].map(function(e){p.executeFile("streaming",e)});for(var r=p.db.prepare("INSERT INTO events (ts, val, id, a, b) VALUES (?, ?, ?, ?, ?)"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=p.db.prepare("INSERT INTO user (ts, id, c, d) VALUES (?, ?, ?, ?)"),o=0;o<10;o++)e(0,1e4*o+Math.round(5e3*Math.random()));for(var o=0;o<5;o++)n(o);var s=window.setInterval(e,1e3);window.eventItv=s;var l=window.setInterval(n,5e3);window.userItv=l}function a(e){var t=p.db.exec(e);return t.length>0?t[0].values[0]:[null,null]}function i(e){var t=p.db.exec("select * from chartTimeData");if(t.length>0){var n=t[0].values;n&&e.setLineChartDataState(n.map(function(e){return{x:e[0],y:e[1]}}))}var r=a("select low, high from currentBrush");e.setLineChartFilter(r[0],r[1])}function o(e){var t=a("select * from allHistoryRange"),n=a("select low, high from currentFilter");n[0]<t[0]||(n[1],t[1]),e.setTimelineState(t[0],t[1],n[0],n[1])}function s(e){var t=p.db.exec("select * from filteredDataTableView");t.length>0&&e.setTableViewValues(t[0].values)}function l(e,n){var r=p.db.exec("select * from "+e);if(r.length>0){var a=r[0].values,i={};a.forEach(function(e){i[e[0]]=e[1]}),a&&n.setChartDataState(t.series[e].map(function(e){return i[e]}))}}function c(e,t){p.db.run("insert into itx (ts, low, high, itxType) values ("+ +Date.now()+", "+e+", "+t+", 'window')")}function u(e){void 0===e&&(e="userBrush"),p.db.run("insert into itx (ts, low, high, itxType) values ("+ +Date.now()+", -1, -1, '"+e+"')")}function d(e,t,n,r,a){p.db.run("insert into itx (ts, low, high, relativeLow, relativeHigh, itxType, itxFixType) values ("+ +Date.now()+", "+e+", "+t+", "+n+", "+r+", 'userBrush', '"+a+"')")}function h(){p.db.run("insert into itxBlockingHelper (ts, eType) values ("+ +Date.now()+", 'start')")}function f(){p.db.run("insert into itxBlockingHelper (ts, eType) values ("+ +Date.now()+", 'end')")}Object.defineProperty(t,"__esModule",{value:!0});var m=n(2),p=n(3);t.chartAName="chartA",t.chartBName="chartB",t.chartScatterName="chartScatter",t.aSeries=["east coast","west coast","other"],t.bSeries=["m","f","undefined"],t.series={chartAData:t.aSeries,chartBData:t.bSeries},t.setupDial=r,t.setLineChartStateHelper=i,t.setTimelineStateHelper=o,t.setTableViewHelper=s,t.setBarChartStateHelper=l,t.setWindow=c,t.removeBrush=u,t.brushItx=d,t.brushStartItx=h,t.brushEndItx=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(6),i=n(7);a.render(r.createElement(i.PageContainer,null),document.getElementById("wrapper"))},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(8);t.PageContainer=function(){return r.createElement(r.Fragment,null,r.createElement(a.default,null))}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(3),o=n(1),s=n(10),l=n(11),c=n(13),u=n(14),d=n(4),h=function(e){function t(t){var n=e.call(this,t)||this;return n.refreshAllCharts=n.refreshAllCharts.bind(n),n.changeDesign=n.changeDesign.bind(n),n.refreshAllCharts=n.refreshAllCharts.bind(n),n.state={start:0,end:t.interval,design:o.SelectionDesign.data},n}return r(t,e),t.prototype.componentDidMount=function(){i.db.create_function("refreshAllCharts",this.refreshAllCharts),d.setupDial()},t.prototype.refreshAllCharts=function(){d.setLineChartStateHelper(this.lineChart),d.setBarChartStateHelper("chartAData",this.chartA),d.setBarChartStateHelper("chartBData",this.chartB),d.setTimelineStateHelper(this.timeline),d.setTableViewHelper(this.tableView)},t.prototype.changeDesign=function(e){var t=e.target.value,n=o.SelectionDesign[t];this.setState({design:n}),i.db.run("insert into table itxPolicy (val) values ("+t+");")},t.prototype.render=function(){var e=this;return a.createElement(a.Fragment,null,a.createElement("h1",null,"Interaction on Quicksand"),a.createElement("p",null,"Directly brushing on streaming data is confusing.  We have created a few different types of brushes to help stablizing visual representations in streaming data analytics.  They are instrumented on the ",a.createElement("b",null,"line chart"),".  In addition to the selections on the line chart, you can also brush on the timeline to select a specific region of time, which will also update the chart data in the linechart."),a.createElement("p",null,'The data is randomly generated on the client. It emulates monitoring "sales" data.  For each new "sales" event, the sum of the prices of items sold per minute is aggregated in the linechart, and the bar charts show the distribution of the attributes associated with these sales events.'),a.createElement("h2",null,'Brush: "Scale Section"'),a.createElement("p",null,"Here, brushing the data will only select the period of time, and as the scale slides left due to streaming data, the selected region will slowly disappear."),a.createElement("h2",null,'Shift-Brush: "Clipped Scale Selection"'),a.createElement("p",null,"The clip selection is fixed to the chart, and forces the charts to reactively update when there are new data that falls into the selected region. This interaction is good for monitoring, if for any reason the existing streaming interaction is not set up to your liking."),a.createElement("p",null,"The clip brushed region will also show up as a brush in the line chart, which can give a visual hint about where in time you are compared to the most recent point in the data stream."),a.createElement(s.default,{ref:function(t){return e.lineChart=t},design:this.state.design,label:"Sales"}),a.createElement(l.default,{ref:function(t){return e.chartA=t},chartName:d.chartAName,series:d.aSeries,label:"Location Distribution"}),a.createElement(l.default,{ref:function(t){return e.chartB=t},chartName:d.chartBName,series:d.bSeries,label:"Gender Distribution"}),a.createElement(c.default,{ref:function(t){return e.timeline=t}}),a.createElement(u.default,{ref:function(t){return e.tableView=t},headers:["time","sales","id","demographic","gender"]}))},t.defaultProps={interval:100},t}(a.Component);t.default=h},function(e,t){e.exports=SQL},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(2),o=n(3),s=n(4),l=n(1),c=function(e){function t(t){var n=e.call(this,t)||this;return n.removeBrushPixels=n.removeBrushPixels.bind(n),n.state={data:null,low:null,high:null},n}return r(t,e),t.prototype.componentDidMount=function(){o.db.create_function("removeBrushPixels",this.removeBrushPixels)},t.prototype.setLineChartDataState=function(e){this.setState({data:e})},t.prototype.setLineChartFilter=function(e,t){this.setState({low:e,high:t})},t.prototype.removeBrushPixels=function(){i.select(this.brushG).call(this.brush.move,null)},t.prototype.render=function(){var e=this,t=this.props,n=t.width,r=t.height,o=t.marginLeft,c=t.marginRight,u=t.marginTop,d=t.marginBottom,h=t.spinnerRadius,f=this.state.data,m=null,p=n-o-c,g=r-u-d;if(f){var v=i.scaleLinear().rangeRound([g,0]).domain(i.extent(f,function(e){return e.y})),b=i.scaleLinear().rangeRound([0,p]).domain(i.extent(f,function(e){return e.x}));this.x=b;var y=i.line().x(function(e){return b(e.x)}).y(function(e){return v(e.y)}),w=y(f),x=null;this.state.low&&this.state.high&&(x=y(f.filter(function(t){return t.x<e.state.high&&t.x>e.state.low})));var E=(this.removeBrushPixels,i.brushX().extent([[0,0],[p,g]]).on("start",function(){i.event.sourceEvent&&"mousedown"===i.event.sourceEvent.type&&s.brushStartItx()}).on("end",function(){var e="data";i.event.sourceEvent&&"mouseup"===i.event.sourceEvent.type&&(window.event.shiftKey&&(e="scale"),s.brushEndItx());var t=i.brushSelection(this);if(console.log("source event",i.event.sourceEvent),null===t)i.event.sourceEvent&&"mouseup"===i.event.sourceEvent.type&&s.removeBrush();else{var n=t.map(b.invert);console.log("brushed",i.brushSelection(this),"mapped",n),s.brushItx(n[0],n[1],t[0]/p,t[1]/p,e)}}));this.brush=E,m=a.createElement("g",null,a.createElement("path",{stroke:"steelblue",fill:"none","stroke-wdith":"1.5",d:w}),a.createElement("path",{stroke:"red",fill:"none","stroke-wdith":"1.5",d:x}),a.createElement("g",{ref:function(t){e.brushG=t,i.select(t).call(E)}}),a.createElement("g",{ref:function(e){return i.select(e).call(i.axisLeft(v).ticks(5))}}),a.createElement("g",{ref:function(e){return i.select(e).call(i.axisBottom(b).ticks(4).tickFormat(l.getFormattedTime)).selectAll("text").attr("transform","rotate(-35)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em")},transform:"translate(0,"+g+")"}),null)}return a.createElement("svg",{width:n,height:r+3*h},a.createElement("g",{transform:"translate("+o+","+u+")"},m))},t.defaultProps={colorOverride:!1,height:200,spinnerRadius:20,marginBottom:40,marginLeft:50,marginRight:50,marginTop:20,width:600},t}(a.Component);t.default=c},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(2),o=n(12),s=function(e){function t(t){var n=e.call(this,t)||this;return n.setChartPending=n.setChartPending.bind(n),n.setChartDataState=n.setChartDataState.bind(n),n.state={data:null,pending:!1},n}return r(t,e),t.prototype.setChartPending=function(e){this.setState({pending:e})},t.prototype.setChartDataState=function(e){this.setState({data:e})},t.prototype.render=function(){var e=this.props,t=e.width,n=e.height,r=e.series,s=e.marginLeft,l=e.marginRight,c=e.marginTop,u=e.marginBottom,d=e.spinnerRadius,h=this.state,f=h.data,m=h.pending,p=null,g=null;if(m&&(p=a.createElement(o.SvgSpinner,{color:"#FFEA19",cx:t/2,radius:d,cy:d})),f){var v=t-s-l,b=n-c-u,y=i.scaleBand().rangeRound([0,v]).padding(.2).domain(r),w=i.scaleLinear().rangeRound([b,0]).domain([0,i.max(f)]),x=f.map(function(e,t){return a.createElement("rect",{x:y(r[t]),y:w(e)?w(e):0,width:y.bandwidth(),height:b-w(e),fill:"rgb(255, 192, 203, 0.5)"})});g=a.createElement("g",null,x,a.createElement("g",{ref:function(e){return i.select(e).call(i.axisLeft(w).ticks(5))}}),a.createElement("g",{ref:function(e){return i.select(e).call(i.axisBottom(y).ticks(4)).selectAll("text").attr("transform","rotate(-35)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em")},transform:"translate(0,"+b+")"}),p)}else g=p;return a.createElement("svg",{width:t,height:n+3*d},a.createElement("g",{transform:"translate("+s+","+c+")"},g))},t.defaultProps={colorOverride:!1,height:150,spinnerRadius:20,marginBottom:40,marginLeft:50,marginRight:25,marginTop:20,width:300},t}(a.Component);t.default=s},function(e,t,n){"use strict";function r(e,t,n,r){return a.createElement("circle",{cx:t,cy:n,r:"1"},a.createElement("animate",{attributeName:"r",begin:e,dur:"1.8s",values:"1; "+r,calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),a.createElement("animate",{attributeName:"stroke-opacity",begin:"0s",dur:"1.8s",values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"}))}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.SvgSpinner=function(e){return a.createElement("g",{fill:"none",stroke:e.color,"fill-rule":"evenodd","stroke-width":"2"},r("0s",e.cx,e.cy,e.radius),r("-0.9s",e.cx,e.cy,e.radius))}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(2),o=n(4),s=n(1),l=function(e){function t(t){var n=e.call(this,t)||this;return n.setTimelineState=n.setTimelineState.bind(n),n.setTimelineSelections=n.setTimelineSelections.bind(n),n.setClipped=n.setClipped.bind(n),n.state={minTime:0,maxTime:1,minWindow:0,maxWindow:1,clipped:!1,selections:[]},n}return r(t,e),t.prototype.setTimelineState=function(e,t,n,r){this.setState({minTime:e,maxTime:t,minWindow:n,maxWindow:r})},t.prototype.setTimelineSelections=function(e){this.setState({selections:e})},t.prototype.setClipped=function(e){this.setState({clipped:e})},t.prototype.render=function(){var e=this.state,t=e.minTime,n=e.maxTime,r=e.minWindow,l=e.maxWindow,c=this.props,u=c.lineWidth,d=c.height,h=c.margin,f=c.fontSize,m=i.scaleLinear().rangeRound([0,u]).domain([t,n]),p=null,g=i.brushX().extent([[0,0],[u,d]]).on("start",function(){}).on("end",function(){if(i.event.sourceEvent&&"mouseup"===i.event.sourceEvent.type){var e=i.brushSelection(this);if(null===e)i.event.sourceEvent&&"mouseup"===i.event.sourceEvent.type&&o.removeBrush("window");else{var t=e.map(m.invert).map(Math.round);o.setWindow(t[0],t[1])}}});if(r-t>0&&l){var v=m(r),b=m(l);p=a.createElement("g",null,a.createElement("text",{x:v,y:d,"font-size":f},s.getFormattedTime(r)),a.createElement("text",{x:b,y:20,"font-size":f},s.getFormattedTime(l)),a.createElement("g",{ref:function(e){i.select(e).call(g),i.select(e).call(g.move,[v,b])}}))}else p=a.createElement("g",{ref:function(e){i.select(e).call(g)}});return a.createElement("svg",{width:u+h.left+h.right,height:d},a.createElement("text",{x:"0",y:d,"font-size":f},s.getFormattedTime(t)),a.createElement("g",{transform:"translate("+h.left+", 0)"},a.createElement("line",{x1:m(t),y1:d/2,x2:m(n),y2:d/2,stroke:"gray","stroke-width":"5"}),p),a.createElement("text",{x:u,y:d,"font-size":f},s.getFormattedTime(n)))},t.defaultProps={height:50,lineWidth:600,fontSize:14,margin:{left:50,right:50}},t}(a.Component);t.default=l},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(1),o=function(e){function t(t){var n=e.call(this,t)||this;return n.setTableViewValues=n.setTableViewValues.bind(n),n.state={records:null},n}return r(t,e),t.prototype.setTableViewValues=function(e){this.setState({records:e})},t.prototype.render=function(){var e=this.props.headers,t=this.state.records,n=null;if(t){var r=a.createElement("thead",null,a.createElement("tr",null,e.map(function(e){return a.createElement("th",{scope:"col"},e)}))),o=t.map(function(e){return a.createElement("tr",null,e.map(function(e,t){return 0===t?a.createElement("th",{scope:"row"},i.getFormattedTime(e)):1===t?a.createElement("td",null,Math.round(e)):a.createElement("td",null,e)}))});n=a.createElement("table",{className:"table"},r,a.createElement("tbody",null,o))}return a.createElement("div",{style:{padding:30,width:700}},n)},t}(a.Component);t.default=o}]);
//# sourceMappingURL=bundle.js.map